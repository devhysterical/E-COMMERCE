{"version":3,"sources":["../../src/categories/categories.service.ts"],"sourcesContent":["import { Injectable, NotFoundException } from '@nestjs/common';\r\nimport { PrismaService } from '../prisma/prisma.service';\r\nimport { CreateCategoryDto, UpdateCategoryDto } from './dto/category.dto';\r\n\r\n@Injectable()\r\nexport class CategoriesService {\r\n  constructor(private prisma: PrismaService) {}\r\n\r\n  async create(dto: CreateCategoryDto) {\r\n    return this.prisma.category.create({\r\n      data: dto,\r\n    });\r\n  }\r\n\r\n  async findAll() {\r\n    return this.prisma.category.findMany({\r\n      where: { deletedAt: null },\r\n      include: {\r\n        _count: {\r\n          select: { products: true },\r\n        },\r\n      },\r\n    });\r\n  }\r\n\r\n  async findOne(id: string) {\r\n    const category = await this.prisma.category.findFirst({\r\n      where: { id, deletedAt: null },\r\n    });\r\n    if (!category) {\r\n      throw new NotFoundException('Không tìm thấy danh mục');\r\n    }\r\n    return category;\r\n  }\r\n\r\n  async update(id: string, dto: UpdateCategoryDto) {\r\n    await this.findOne(id);\r\n    return this.prisma.category.update({\r\n      where: { id },\r\n      data: dto,\r\n    });\r\n  }\r\n\r\n  async remove(id: string) {\r\n    await this.findOne(id);\r\n    return this.prisma.category.update({\r\n      where: { id },\r\n      data: { deletedAt: new Date() },\r\n    });\r\n  }\r\n}\r\n"],"names":["CategoriesService","create","dto","prisma","category","data","findAll","findMany","where","deletedAt","include","_count","select","products","findOne","id","findFirst","NotFoundException","update","remove","Date"],"mappings":";;;;+BAKaA;;;eAAAA;;;wBALiC;+BAChB;;;;;;;;;;AAIvB,IAAA,AAAMA,oBAAN,MAAMA;IAGX,MAAMC,OAAOC,GAAsB,EAAE;QACnC,OAAO,IAAI,CAACC,MAAM,CAACC,QAAQ,CAACH,MAAM,CAAC;YACjCI,MAAMH;QACR;IACF;IAEA,MAAMI,UAAU;QACd,OAAO,IAAI,CAACH,MAAM,CAACC,QAAQ,CAACG,QAAQ,CAAC;YACnCC,OAAO;gBAAEC,WAAW;YAAK;YACzBC,SAAS;gBACPC,QAAQ;oBACNC,QAAQ;wBAAEC,UAAU;oBAAK;gBAC3B;YACF;QACF;IACF;IAEA,MAAMC,QAAQC,EAAU,EAAE;QACxB,MAAMX,WAAW,MAAM,IAAI,CAACD,MAAM,CAACC,QAAQ,CAACY,SAAS,CAAC;YACpDR,OAAO;gBAAEO;gBAAIN,WAAW;YAAK;QAC/B;QACA,IAAI,CAACL,UAAU;YACb,MAAM,IAAIa,yBAAiB,CAAC;QAC9B;QACA,OAAOb;IACT;IAEA,MAAMc,OAAOH,EAAU,EAAEb,GAAsB,EAAE;QAC/C,MAAM,IAAI,CAACY,OAAO,CAACC;QACnB,OAAO,IAAI,CAACZ,MAAM,CAACC,QAAQ,CAACc,MAAM,CAAC;YACjCV,OAAO;gBAAEO;YAAG;YACZV,MAAMH;QACR;IACF;IAEA,MAAMiB,OAAOJ,EAAU,EAAE;QACvB,MAAM,IAAI,CAACD,OAAO,CAACC;QACnB,OAAO,IAAI,CAACZ,MAAM,CAACC,QAAQ,CAACc,MAAM,CAAC;YACjCV,OAAO;gBAAEO;YAAG;YACZV,MAAM;gBAAEI,WAAW,IAAIW;YAAO;QAChC;IACF;IA3CA,YAAY,AAAQjB,MAAqB,CAAE;aAAvBA,SAAAA;IAAwB;AA4C9C"}