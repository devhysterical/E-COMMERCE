{"version":3,"sources":["../../src/shipping/shipping.controller.ts"],"sourcesContent":["import {\r\n  Controller,\r\n  Get,\r\n  Post,\r\n  Patch,\r\n  Delete,\r\n  Body,\r\n  Param,\r\n  Query,\r\n  UseGuards,\r\n} from '@nestjs/common';\r\nimport { ShippingService } from './shipping.service';\r\nimport {\r\n  CreateShippingZoneDto,\r\n  UpdateShippingZoneDto,\r\n  AssignProvincesDto,\r\n} from './dto';\r\nimport { JwtAuthGuard } from '../auth/guards/jwt-auth.guard';\r\nimport { RolesGuard } from '../common/guards/roles.guard';\r\nimport { Roles } from '../common/decorators/roles.decorator';\r\n\r\n@Controller('shipping')\r\nexport class ShippingController {\r\n  constructor(private readonly shippingService: ShippingService) {}\r\n\r\n  // ===== PUBLIC ENDPOINTS =====\r\n\r\n  // Get all active zones (public)\r\n  @Get('zones')\r\n  async getActiveZones() {\r\n    return this.shippingService.getActiveZones();\r\n  }\r\n\r\n  // Calculate shipping fee by province (public)\r\n  @Get('fee')\r\n  async calculateFee(\r\n    @Query('province') province: string,\r\n    @Query('orderTotal') orderTotal?: string,\r\n  ) {\r\n    const total = orderTotal ? parseInt(orderTotal, 10) : undefined;\r\n    return this.shippingService.calculateFee(province, total);\r\n  }\r\n\r\n  // Get all provinces with zones (public)\r\n  @Get('provinces')\r\n  async getAllProvinces() {\r\n    return this.shippingService.getAllProvinces();\r\n  }\r\n\r\n  // ===== ADMIN ENDPOINTS =====\r\n\r\n  // Get all zones (admin)\r\n  @Get('admin/zones')\r\n  @UseGuards(JwtAuthGuard, RolesGuard)\r\n  @Roles('ADMIN')\r\n  async getAllZones() {\r\n    return this.shippingService.getAllZones();\r\n  }\r\n\r\n  // Get zone by ID (admin)\r\n  @Get('admin/zones/:id')\r\n  @UseGuards(JwtAuthGuard, RolesGuard)\r\n  @Roles('ADMIN')\r\n  async getZoneById(@Param('id') id: string) {\r\n    return this.shippingService.getZoneById(id);\r\n  }\r\n\r\n  // Create zone (admin)\r\n  @Post('admin/zones')\r\n  @UseGuards(JwtAuthGuard, RolesGuard)\r\n  @Roles('ADMIN')\r\n  async createZone(@Body() dto: CreateShippingZoneDto) {\r\n    return this.shippingService.createZone(dto);\r\n  }\r\n\r\n  // Update zone (admin)\r\n  @Patch('admin/zones/:id')\r\n  @UseGuards(JwtAuthGuard, RolesGuard)\r\n  @Roles('ADMIN')\r\n  async updateZone(\r\n    @Param('id') id: string,\r\n    @Body() dto: UpdateShippingZoneDto,\r\n  ) {\r\n    return this.shippingService.updateZone(id, dto);\r\n  }\r\n\r\n  // Delete zone (admin)\r\n  @Delete('admin/zones/:id')\r\n  @UseGuards(JwtAuthGuard, RolesGuard)\r\n  @Roles('ADMIN')\r\n  async deleteZone(@Param('id') id: string) {\r\n    return this.shippingService.deleteZone(id);\r\n  }\r\n\r\n  // Assign provinces to zone (admin)\r\n  @Post('admin/zones/:id/provinces')\r\n  @UseGuards(JwtAuthGuard, RolesGuard)\r\n  @Roles('ADMIN')\r\n  async assignProvinces(\r\n    @Param('id') id: string,\r\n    @Body() dto: AssignProvincesDto,\r\n  ) {\r\n    return this.shippingService.assignProvinces(id, dto.provinces);\r\n  }\r\n}\r\n"],"names":["ShippingController","getActiveZones","shippingService","calculateFee","province","orderTotal","total","parseInt","undefined","getAllProvinces","getAllZones","getZoneById","id","createZone","dto","updateZone","deleteZone","assignProvinces","provinces"],"mappings":";;;;+BAsBaA;;;eAAAA;;;wBAZN;iCACyB;qBAKzB;8BACsB;4BACF;gCACL;;;;;;;;;;;;;;;AAGf,IAAA,AAAMA,qBAAN,MAAMA;IAGX,+BAA+B;IAE/B,gCAAgC;IAChC,MACMC,iBAAiB;QACrB,OAAO,IAAI,CAACC,eAAe,CAACD,cAAc;IAC5C;IAEA,8CAA8C;IAC9C,MACME,aACJ,AAAmBC,QAAgB,EACnC,AAAqBC,UAAmB,EACxC;QACA,MAAMC,QAAQD,aAAaE,SAASF,YAAY,MAAMG;QACtD,OAAO,IAAI,CAACN,eAAe,CAACC,YAAY,CAACC,UAAUE;IACrD;IAEA,wCAAwC;IACxC,MACMG,kBAAkB;QACtB,OAAO,IAAI,CAACP,eAAe,CAACO,eAAe;IAC7C;IAEA,8BAA8B;IAE9B,wBAAwB;IACxB,MAGMC,cAAc;QAClB,OAAO,IAAI,CAACR,eAAe,CAACQ,WAAW;IACzC;IAEA,yBAAyB;IACzB,MAGMC,YAAY,AAAaC,EAAU,EAAE;QACzC,OAAO,IAAI,CAACV,eAAe,CAACS,WAAW,CAACC;IAC1C;IAEA,sBAAsB;IACtB,MAGMC,WAAW,AAAQC,GAA0B,EAAE;QACnD,OAAO,IAAI,CAACZ,eAAe,CAACW,UAAU,CAACC;IACzC;IAEA,sBAAsB;IACtB,MAGMC,WACJ,AAAaH,EAAU,EACvB,AAAQE,GAA0B,EAClC;QACA,OAAO,IAAI,CAACZ,eAAe,CAACa,UAAU,CAACH,IAAIE;IAC7C;IAEA,sBAAsB;IACtB,MAGME,WAAW,AAAaJ,EAAU,EAAE;QACxC,OAAO,IAAI,CAACV,eAAe,CAACc,UAAU,CAACJ;IACzC;IAEA,mCAAmC;IACnC,MAGMK,gBACJ,AAAaL,EAAU,EACvB,AAAQE,GAAuB,EAC/B;QACA,OAAO,IAAI,CAACZ,eAAe,CAACe,eAAe,CAACL,IAAIE,IAAII,SAAS;IAC/D;IAhFA,YAAY,AAAiBhB,eAAgC,CAAE;aAAlCA,kBAAAA;IAAmC;AAiFlE"}