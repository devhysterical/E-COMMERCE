{"version":3,"sources":["../src/main.ts"],"sourcesContent":["import { NestFactory } from '@nestjs/core';\r\nimport { AppModule } from './app.module';\r\nimport { ValidationPipe } from '@nestjs/common';\r\nimport { json, urlencoded } from 'express';\r\nimport helmet from 'helmet';\r\n\r\nasync function bootstrap() {\r\n  const app = await NestFactory.create(AppModule);\r\n\r\n  // Security headers\r\n  app.use(helmet());\r\n\r\n  // Tăng body limit để hỗ trợ upload hình ảnh base64\r\n  app.use(json({ limit: '10mb' }));\r\n  app.use(urlencoded({ extended: true, limit: '10mb' }));\r\n\r\n  // Kích hoạt ValidationPipe toàn cục\r\n  app.useGlobalPipes(\r\n    new ValidationPipe({\r\n      whitelist: true,\r\n      forbidNonWhitelisted: true,\r\n      transform: true,\r\n    }),\r\n  );\r\n\r\n  // Cấu hình CORS chặt chẽ\r\n  const allowedOrigins = (process.env.FRONTEND_URL || 'http://localhost:5173')\r\n    .split(',')\r\n    .map((origin) => origin.trim());\r\n\r\n  app.enableCors({\r\n    origin: allowedOrigins,\r\n    methods: ['GET', 'POST', 'PUT', 'PATCH', 'DELETE'],\r\n    credentials: true,\r\n  });\r\n\r\n  await app.listen(process.env.PORT ?? 4000);\r\n}\r\nvoid bootstrap();\r\n"],"names":["bootstrap","app","NestFactory","create","AppModule","use","helmet","json","limit","urlencoded","extended","useGlobalPipes","ValidationPipe","whitelist","forbidNonWhitelisted","transform","allowedOrigins","process","env","FRONTEND_URL","split","map","origin","trim","enableCors","methods","credentials","listen","PORT"],"mappings":";;;;sBAA4B;2BACF;wBACK;yBACE;+DACd;;;;;;AAEnB,eAAeA;IACb,MAAMC,MAAM,MAAMC,iBAAW,CAACC,MAAM,CAACC,oBAAS;IAE9C,mBAAmB;IACnBH,IAAII,GAAG,CAACC,IAAAA,eAAM;IAEd,mDAAmD;IACnDL,IAAII,GAAG,CAACE,IAAAA,aAAI,EAAC;QAAEC,OAAO;IAAO;IAC7BP,IAAII,GAAG,CAACI,IAAAA,mBAAU,EAAC;QAAEC,UAAU;QAAMF,OAAO;IAAO;IAEnD,oCAAoC;IACpCP,IAAIU,cAAc,CAChB,IAAIC,sBAAc,CAAC;QACjBC,WAAW;QACXC,sBAAsB;QACtBC,WAAW;IACb;IAGF,yBAAyB;IACzB,MAAMC,iBAAiB,AAACC,CAAAA,QAAQC,GAAG,CAACC,YAAY,IAAI,uBAAsB,EACvEC,KAAK,CAAC,KACNC,GAAG,CAAC,CAACC,SAAWA,OAAOC,IAAI;IAE9BtB,IAAIuB,UAAU,CAAC;QACbF,QAAQN;QACRS,SAAS;YAAC;YAAO;YAAQ;YAAO;YAAS;SAAS;QAClDC,aAAa;IACf;IAEA,MAAMzB,IAAI0B,MAAM,CAACV,QAAQC,GAAG,CAACU,IAAI,IAAI;AACvC;AACA,KAAK5B"}