{"version":3,"sources":["../../src/orders/orders.controller.ts"],"sourcesContent":["import {\r\n  Controller,\r\n  Get,\r\n  Post,\r\n  Body,\r\n  Param,\r\n  UseGuards,\r\n  Patch,\r\n} from '@nestjs/common';\r\nimport { OrdersService } from './orders.service';\r\nimport { JwtAuthGuard } from '../auth/guards/jwt-auth.guard';\r\nimport { RolesGuard } from '../common/guards/roles.guard';\r\nimport { Roles } from '../common/decorators/roles.decorator';\r\nimport { GetUser } from '../common/decorators/get-user.decorator';\r\nimport { OrderStatus, PaymentMethod } from '@prisma/client';\r\n\r\n@Controller('orders')\r\n@UseGuards(JwtAuthGuard)\r\nexport class OrdersController {\r\n  constructor(private readonly ordersService: OrdersService) {}\r\n\r\n  @Post()\r\n  createOrder(\r\n    @GetUser('userId') userId: string,\r\n    @Body()\r\n    dto: {\r\n      address: string;\r\n      phone: string;\r\n      paymentMethod?: PaymentMethod;\r\n      couponId?: string;\r\n    },\r\n  ) {\r\n    return this.ordersService.createOrder(\r\n      userId,\r\n      dto.address,\r\n      dto.phone,\r\n      dto.paymentMethod || 'COD',\r\n      dto.couponId,\r\n    );\r\n  }\r\n\r\n  @Get()\r\n  findAll(@GetUser('userId') userId: string) {\r\n    return this.ordersService.findAll(userId);\r\n  }\r\n\r\n  @Get(':id')\r\n  findOne(@Param('id') id: string, @GetUser('userId') userId: string) {\r\n    return this.ordersService.findOne(id, userId);\r\n  }\r\n\r\n  // Admin APIs\r\n  @Get('admin/all')\r\n  @UseGuards(RolesGuard)\r\n  @Roles('ADMIN')\r\n  findAllAdmin() {\r\n    return this.ordersService.findAllAdmin();\r\n  }\r\n\r\n  @Get('admin/stats')\r\n  @UseGuards(RolesGuard)\r\n  @Roles('ADMIN')\r\n  getStats() {\r\n    return this.ordersService.getStats();\r\n  }\r\n\r\n  @Patch('admin/:id/status')\r\n  @UseGuards(RolesGuard)\r\n  @Roles('ADMIN')\r\n  updateStatus(@Param('id') id: string, @Body() dto: { status: OrderStatus }) {\r\n    return this.ordersService.updateStatus(id, dto.status);\r\n  }\r\n}\r\n"],"names":["OrdersController","createOrder","userId","dto","ordersService","address","phone","paymentMethod","couponId","findAll","findOne","id","findAllAdmin","getStats","updateStatus","status"],"mappings":";;;;+BAkBaA;;;eAAAA;;;wBAVN;+BACuB;8BACD;4BACF;gCACL;kCACE;;;;;;;;;;;;;;;AAKjB,IAAA,AAAMA,mBAAN,MAAMA;IAIXC,YACE,AAAmBC,MAAc,EACjC,AACAC,GAKC,EACD;QACA,OAAO,IAAI,CAACC,aAAa,CAACH,WAAW,CACnCC,QACAC,IAAIE,OAAO,EACXF,IAAIG,KAAK,EACTH,IAAII,aAAa,IAAI,OACrBJ,IAAIK,QAAQ;IAEhB;IAGAC,QAAQ,AAAmBP,MAAc,EAAE;QACzC,OAAO,IAAI,CAACE,aAAa,CAACK,OAAO,CAACP;IACpC;IAGAQ,QAAQ,AAAaC,EAAU,EAAE,AAAmBT,MAAc,EAAE;QAClE,OAAO,IAAI,CAACE,aAAa,CAACM,OAAO,CAACC,IAAIT;IACxC;IAEA,aAAa;IAIbU,eAAe;QACb,OAAO,IAAI,CAACR,aAAa,CAACQ,YAAY;IACxC;IAKAC,WAAW;QACT,OAAO,IAAI,CAACT,aAAa,CAACS,QAAQ;IACpC;IAKAC,aAAa,AAAaH,EAAU,EAAE,AAAQR,GAA4B,EAAE;QAC1E,OAAO,IAAI,CAACC,aAAa,CAACU,YAAY,CAACH,IAAIR,IAAIY,MAAM;IACvD;IApDA,YAAY,AAAiBX,aAA4B,CAAE;aAA9BA,gBAAAA;IAA+B;AAqD9D"}